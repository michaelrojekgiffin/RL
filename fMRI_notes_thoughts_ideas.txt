fMRI notes thoughts and ideas

LUMC password: P!gletg1ff1n

idea from the Knoch & Fehr paper 2006 - they say that there's evidence that a responder utilizes the anterior insula and the DLPFC when deciding whether or not to reject or accept an unfair offer, perhaps we'll find something similar in our proposers when they're deliberating whether or not make what appears to them to be an unfair offer. 


I'm installing fmri_prep using a docker container and then a singularily container. Had to install future with pip first to get it to work.

then I used this command to get it mapped onto the shark cluster

 docker run --privileged -t --rm \
    -v /var/run/docker.sock:/var/run/docker.sock \
    -v /Users/michaelgiffin/shark_data:/output \
    singularityware/docker2singularity \
    poldracklab/fmriprep:latest


### and then run this command - IMPORTANTLY - I must be in the directory on my own machine where the image exists. In other words, from my own terminal I have to cd to ~/shark_data, and then run the following command. Takes roughly 9 hours

scp -oProxyJump=shark_jump poldracklab_fmriprep_latest-*.img mrgiffin@localhost:/exports/fsw/mrgiffin/


#### and then test it with this

module load fsl/5.0.9-shark

module load freesurfer/5.3.0

module load singularity/2.4.1

PYTHONPATH="" singularity run /exports/fsw/mrgiffin/poldracklab_fmriprep_latest-2018-02-23-faf5170f3072.img --fs-license-file /usr/local/Freesurfer/freesurfer-Linux-centos6_x86_64-stable-pub-v5.3.0/freesurfer /exports/fsw/mrgiffin/UG/BIDS /exports/fsw/mrgiffin/UG/fMRI_prepped participant -w /exports/fsw/mrgiffin/UG/fMRI_prepped_interim


## but it can't find the freesurfer license so I'm trying to bind it to the container with the folloing

singularity shell -B /exports/fsw/mrgiffin:/scratch /exports/fsw/mrgiffin/poldracklab_fmriprep_latest-2018-02-23-faf5170f3072.img


I submitted it from the BIDS/code/fMRI_prep_bash.sh script.

module load singularity/2.4.1

PYTHONPATH="" singularity run /exports/fsw/mrgiffin/poldracklab_fmriprep_latest-2018-02-23-faf5170f3072.img --fs-license-file $HOME/license.txt /exports/fsw/mrgiffin/UG/BIDS /exports/fsw/mrgiffin/UG/fMRI_prepped participant -w /exports/fsw/mrgiffin/UG/fMRI_prepped_interim



####
Which means that I'll likely be using fmri_prep for my pre-processing, and then GLM_DENOISE as well, so I'll have to cite that too. 
###

Importantly, when using GLM_denoise, I'm gonna turn off the high-pass filtereing and just run the pre-processing steps.


Next, for today, I'm going to see if there's a difference in the response to our different opponents across the social and the non-social conditions. How to test this is an interesting question answered here: The right thing to do is make 3 separate regressors and then contrast them in all the different ways, according to fsl:
https://fsl.fmrib.ox.ac.uk/fslcourse/lectures/feat3.pdf
Then I can run another first level analysis using the filtered_func_data of the QD analysis as input, since that's the data that has been pre-processed. I will have to write a reg_directory_copycat function though. 



used this command to get the ACC mask (multiplied the neurosynth mask thresholded at 6 by harvard oxford):
fslmaths anterior\ cingulate_pFgA_z_FDR_0.01.nii.gz -thr 6 -mul harvardoxford-cortical_prob_Cingulate\ Gyrus\,\ anterior\ division.nii.gz -bin ACC_bin.nii.gz

then I moved it to my masks folder
